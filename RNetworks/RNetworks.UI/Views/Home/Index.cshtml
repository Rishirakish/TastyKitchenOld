@{
    ViewBag.Title = "Home Page";
}
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<div class="jumbotron" style="background-image: url('../../MyApp1/Image/woodBackground1.jpg')">
@*<div>*@
    @*<h1>R-NETWORKS</h1>*@
<p style="color: sandybrown; font-size:xx-large">

    <span>
        <img src="~/Image/logo.png" width="70" height="70"></span> &nbsp;&nbsp;Welcome to <b>Tasty Kitchen</b> Dashboard
</p>
    @*<p><a href="http://gtrl.org.in/" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>*@

    @*<button onclick="lineChart()" title="Display Chart" value="Display Chart" class="btn btn-primary btn-lg">Dashboard</button>*@

</div>

@*<div class="row">*@
    @*<div class="col-md-4">*@
        @*<h2>Getting started</h2>*@
        @*<p>
            ASP.NET MVC gives you a powerful, patterns-based way to build dynamic websites that
            enables a clean separation of concerns and gives you full control over markup
            for enjoyable, agile development.
        </p>*@
        @*<p><a class="btn btn-default" href="http://gtrl.org.in/">Learn more &raquo;</a></p>*@
    @*</div>*@
    @*<div class="col-md-4">
        <h2>Get more libraries</h2>
        <p>NuGet is a free Visual Studio extension that makes it easy to add, remove, and update libraries and tools in Visual Studio projects.</p>
        <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301866">Learn more &raquo;</a></p>
    </div>
    <div class="col-md-4">
        <h2>Web Hosting</h2>
        <p>You can easily find a web hosting company that offers the right mix of features and price for your applications.</p>
        <p><a*@ @*class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301867">Learn more &raquo;</a></p>*@
    @*</div>*@

    <table align="center">
        @*<tbody style="width: 2000px; height: 2000px">*@
        <tr>
            <th style="width:500px;"></th>
            <th style="width: 500px;"></th>
            <th style="width: 500px;"></th>
        </tr>
        <tr>
            <td>
                <br /><br /><br />
                <div id="lineChart"></div>
            </td>
            <td>
                <div id="donutChart"></div>
            </td>
            <td>
                <br /><br />
                <div id="barChart"></div>
            </td>
        </tr>
        <tr>

            <td>
                <br />
                <div id="heatMapChart"></div>
            </td>
            <td>
                <div id="chart-year"></div>
            </td>
            <td>
                <div id="chart-quarter"></div>
            </td>

        </tr>
        @*</tbody>*@
    </table>
@*</div>*@
<script type="text/javascript">
    //function lineChart() {
        var lineOptions = {
            chart: {
                type: 'line'
            },
            series: [
                {
                    name: 'sales',
                    data: [49, 60, 70, 91, 125]
                }
            ],
            title: {
                text: 'Turnover Trend',
                offsetX: 15
            },
            xaxis: {
                categories: [2018, 2019, 2020, 2021, 2022]
            }
        }

        donutOptions = {
            chart: {
                type: 'donut'
            },
            series: [44, 55, 13, 33],
            labels: ['Rent', 'Employee Salary', 'Food material', 'Ambiance'],
            title: {
                text: 'Expense Breakdown',
                offsetX: 15
            }
        }

        var lineChart = new ApexCharts(document.querySelector("#lineChart"), lineOptions);
        var donutChart = new ApexCharts(document.querySelector("#donutChart"), donutOptions);

        lineChart.render();
        donutChart.render();

        var barOptions = {
            chart: {
                type: 'bar'
            },
            series: [
                {
                    name: 'sales',
                    data: [49, 60, 70, 91, 125]
                }
            ],
            title: {
                text: 'Annual sales',
                offsetX: 15
            },
            xaxis: {
                categories: [2018, 2019, 2020, 2021, 2022]
            }
        }

        var barChart = new ApexCharts(document.querySelector('#barChart'), barOptions);
        barChart.render();

        heatMapoptions = {
            chart: {
                type: 'heatmap'
            },
            title: {
                text: 'Monthly Sales',
                offsetX: 15
            },
            plotOptions: {
                heatmap: {
                    colorScale: {
                        ranges: [{
                                from: -30,
                                to: 5,
                                color: '#FF0000',
                                name: 'low',
                            },
                            {
                                from: 6,
                                to: 20,
                                color: '#128FD9',
                                name: 'medium',
                            },
                            {
                                from: 21,
                                to: 45,
                                color: '#00A100',
                                name: 'high',
                            }
                        ]
                    }
                }
            },
            series: [

                {
                    name: "1st Month",
                    data: [{
                        x: 'Q1',
                        y: 22
                    }, {
                        x: 'Q2',
                        y: 29
                    }, {
                        x: 'Q3',
                        y: 13
                    }, {
                        x: 'Q4',
                        y: 32
                    }]
                },
                {
                    name: "2nd Month",
                    data: [
                        {
                            x: 'Q1',
                            y: 6
                        }, {
                            x: 'Q2',
                            y: 4
                        }, {
                            x: 'Q3',
                            y: 20
                        }, {
                            x: 'Q4',
                            y: 0
                        }]
                
                },

                {
                    name: "3rd Month",
                    data: [{
                        x: 'Q1',
                        y: 43
                    }, {
                        x: 'Q2',
                        y: 43
                    }, {
                        x: 'Q3',
                        y: 43
                    }, {
                        x: 'Q4',
                        y: 43
                    }]
                }
            ]
        }
        var heatMapChart = new ApexCharts(document.querySelector('#heatMapChart'), heatMapoptions);
        heatMapChart.render();

        // drill down
        Apex = {
            chart: {
                toolbar: {
                    show: false
                }
            },
            tooltip: {
                shared: false
            },
            legend: {
                show: false
            }
        }

        var colors = ['#008FFB', '#00E396', '#FEB019', '#FF4560', '#775DD0', '#00D9E9', '#FF66C3'];

        /**
         * Randomize array element order in-place.
         * Using Durstenfeld shuffle algorithm.
         */
        function shuffleArray(array) {
            for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
            return array;
        }

        var arrayData = [{
            y: 400,
            quarters: [{
                x: 'Q1',
                y: 120
            }, {
                x: 'Q2',
                y: 90
            }, {
                x: 'Q3',
                y: 100
            }, {
                x: 'Q4',
                y: 90
            }]
        }, {
            y: 430,
            quarters: [{
                x: 'Q1',
                y: 120
            }, {
                x: 'Q2',
                y: 110
            }, {
                x: 'Q3',
                y: 90
            }, {
                x: 'Q4',
                y: 110
            }]
        }, {
            y: 448,
            quarters: [{
                x: 'Q1',
                y: 70
            }, {
                x: 'Q2',
                y: 100
            }, {
                x: 'Q3',
                y: 140
            }, {
                x: 'Q4',
                y: 138
            }]
        }, {
            y: 470,
            quarters: [{
                x: 'Q1',
                y: 150
            }, {
                x: 'Q2',
                y: 60
            }, {
                x: 'Q3',
                y: 190
            }, {
                x: 'Q4',
                y: 70
            }]
        }, {
            y: 540,
            quarters: [{
                x: 'Q1',
                y: 120
            }, {
                x: 'Q2',
                y: 120
            }, {
                x: 'Q3',
                y: 130
            }, {
                x: 'Q4',
                y: 170
            }]
        }, {
            y: 580,
            quarters: [{
                x: 'Q1',
                y: 170
            }, {
                x: 'Q2',
                y: 130
            }, {
                x: 'Q3',
                y: 120
            }, {
                x: 'Q4',
                y: 160
            }]
        }];

        function makeData() {
            var dataSet = shuffleArray(arrayData)

            var dataYearSeries = [{
                x: "2018",
                y: dataSet[1].y,
                color: colors[1],
                quarters: dataSet[1].quarters
            }, {
                x: "2019",
                y: dataSet[2].y,
                color: colors[2],
                quarters: dataSet[2].quarters
            }, {
                x: "2020",
                y: dataSet[3].y,
                color: colors[3],
                quarters: dataSet[3].quarters
            }, {
                x: "2021",
                y: dataSet[4].y,
                color: colors[4],
                quarters: dataSet[4].quarters
            }, {
                x: "2022",
                y: dataSet[5].y,
                color: colors[5],
                quarters: dataSet[5].quarters
            }];

            return dataYearSeries
        }

        function updateQuarterChart(sourceChart, destChartIDToUpdate) {
            var series = [];
            var seriesIndex = 0;
            var colors = []

            if (sourceChart.w.globals.selectedDataPoints[0]) {
                var selectedPoints = sourceChart.w.globals.selectedDataPoints;
                for (var i = 0; i < selectedPoints[seriesIndex].length; i++) {
                    var selectedIndex = selectedPoints[seriesIndex][i];
                    var yearSeries = sourceChart.w.config.series[seriesIndex];
                    series.push({
                        name: yearSeries.data[selectedIndex].x,
                        data: yearSeries.data[selectedIndex].quarters
                    })
                    colors.push(yearSeries.data[selectedIndex].color)
                }

                if (series.length === 0) series = [{
                    data: []
                }]

                return ApexCharts.exec(destChartIDToUpdate, 'updateOptions', {
                    series: series,
                    colors: colors,
                    fill: {
                        colors: colors
                    }
                })
            }
        }
        
        var Drilloptions = {
            series: [{
                data: makeData()
            }],
            chart: {
                id: 'barYear',
                height: 250,
                width: '80%',
                type: 'bar',
                events: {
                    dataPointSelection: function (e, chart, opts) {
                        var quarterChartEl = document.querySelector("#chart-quarter");
                        var yearChartEl = document.querySelector("#chart-year");

                        if (opts.selectedDataPoints[0].length === 1) {
                            if (quarterChartEl.classList.contains("active")) {
                                updateQuarterChart(chart, 'barQuarter')
                            } else {
                                yearChartEl.classList.add("chart-quarter-activated")
                                quarterChartEl.classList.add("active");
                                updateQuarterChart(chart, 'barQuarter')
                            }
                        } else {
                            updateQuarterChart(chart, 'barQuarter')
                        }

                        if (opts.selectedDataPoints[0].length === 0) {
                            yearChartEl.classList.remove("chart-quarter-activated")
                            quarterChartEl.classList.remove("active");
                        }

                    },
                    updated: function (chart) {
                        updateQuarterChart(chart, 'barQuarter')
                    }
                }
            },
            plotOptions: {
                bar: {
                    distributed: true,
                    horizontal: true,
                    barHeight: '75%',
                    dataLabels: {
                        position: 'bottom'
                    }
                }
            },
            dataLabels: {
                enabled: true,
                textAnchor: 'start',
                style: {
                    colors: ['#fff']
                },
                formatter: function (val, opt) {
                    return opt.w.globals.labels[opt.dataPointIndex]
                },
                offsetX: 0,
                dropShadow: {
                    enabled: true
                }
            },

            colors: colors,

            states: {
                normal: {
                    filter: {
                        type: 'desaturate'
                    }
                },
                active: {
                    allowMultipleDataPointsSelection: true,
                    filter: {
                        type: 'darken',
                        value: 1
                    }
                }
            },
            tooltip: {
                x: {
                    show: false
                },
                y: {
                    title: {
                        formatter: function (val, opts) {
                            return opts.w.globals.labels[opts.dataPointIndex]
                        }
                    }
                }
            },
            title: {
                text: 'Yearly Results',
                offsetX: 15
            },
            subtitle: {
                text: '(Click on bar to see details)',
                offsetX: 15
            },
            yaxis: {
                labels: {
                    show: false
                }
            }
        };

        var chart = new ApexCharts(document.querySelector("#chart-year"), Drilloptions);
        chart.render();

        var optionsQuarter = {
            series: [{
                data: []
            }],
            chart: {
                id: 'barQuarter',
                height: 250,
                width: '100%',
                type: 'bar',
                stacked: true
            },
            plotOptions: {
                bar: {
                    columnWidth: '50%',
                    horizontal: false
                }
            },
            legend: {
                show: false
            },
            grid: {
                yaxis: {
                    lines: {
                        show: false,
                    }
                },
                xaxis: {
                    lines: {
                        show: true,
                    }
                }
            },
            yaxis: {
                labels: {
                    show: false
                }
            },
            title: {
                text: 'Quarterly Results',
                offsetX: 10
            },
            tooltip: {
                x: {
                    formatter: function (val, opts) {
                        return opts.w.globals.seriesNames[opts.seriesIndex]
                    }
                },
                y: {
                    title: {
                        formatter: function (val, opts) {
                            return opts.w.globals.labels[opts.dataPointIndex]
                        }
                    }
                }
            }
        };

        var chartQuarter = new ApexCharts(document.querySelector("#chart-quarter"), optionsQuarter);
        chartQuarter.render();


        chart.addEventListener('dataPointSelection', function (e, chart, opts) {
            var quarterChartEl = document.querySelector("#chart-quarter");
            var yearChartEl = document.querySelector("#chart-year");

            if (opts.selectedDataPoints[0].length === 1) {
                if (quarterChartEl.classList.contains("active")) {
                    updateQuarterChart(chart, 'barQuarter')
                }
                else {
                    yearChartEl.classList.add("chart-quarter-activated")
                    quarterChartEl.classList.add("active");
                    updateQuarterChart(chart, 'barQuarter')
                }
            } else {
                updateQuarterChart(chart, 'barQuarter')
            }

            if (opts.selectedDataPoints[0].length === 0) {
                yearChartEl.classList.remove("chart-quarter-activated")
                quarterChartEl.classList.remove("active");
            }

        })

        chart.addEventListener('updated', function (chart) {
            updateQuarterChart(chart, 'barQuarter')
        })

        document.querySelector("#model").addEventListener("change", function (e) {
            chart.updateSeries([{
                data: makeData()
            }])
        })

    //}


</script>

